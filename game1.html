<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<head>
    <script>
        //暂时定义V7为获得页面对象的方式之一。
        var V7=function(id){
            if(document.getElementById(id)){
                return document.getElementById(id)
            }
            else if(parent.window){
                if(parent.window.document.getElementById(id)){
                    return parent.window.document.getElementById(id);
                }
            }
            //*
            else if (top.window){
                if(top.window.document.getElementById(id)){
                    return top.window.document.getElementById(id);
                }
            }//*/

        };

        ws = new WebSocket("ws://127.0.0.1:2346");
        ws.onopen = function() {
            V7("show").innerHTML = "连接成功";
//            alert("连接成功");
            ws.send('玩家B');
//            alert("给服务端发送一个字符串：tom");
        };

        ws.onmessage = function(e) {
//            alert("收到服务端的消息：" + e.data);
            var info = eval("(" + e.data + ")" );
            console.log(info);
            console.log(info.date);
            console.log(info.fight);

            if(info.date){
                V7("show_time").innerHTML = info.date;
            }

            if (info.fight.A) {
                V7("show_fight").innerHTML = info.fight;
                V7("show_a_uid").innerHTML = info.fight.A.uid;
                V7("show_a_name").innerHTML = info.fight.A.name;
                V7("show_a_hp").innerHTML = info.fight.A.hp;
                V7("show_a_dp").innerHTML = info.fight.A.dp;
                V7("show_a_direction").innerHTML = info.fight.A.direct;
            }

            if (info.fight.B) {
                V7("show_fight").innerHTML = info.fight;
                V7("show_b_uid").innerHTML = info.fight.B.uid;
                V7("show_b_name").innerHTML = info.fight.B.name;
                V7("show_b_hp").innerHTML = info.fight.B.hp;
                V7("show_b_dp").innerHTML = info.fight.B.dp;
                V7("show_b_direction").innerHTML = info.fight.B.direct;
            }

        };

        function send_a() {
            ws.send(V7("send_a").value);
            console.log('send_a');
        }

        function send_b() {
            ws.send(V7("send_b").value);
        }
    </script>
</head>

<body>
<table width=600>

    <tr>
        <td width=200 height="60">
            当前时间:<div id="show_time"></div>
        </td>
        <td width=400>
            连接状态:<div id="show"></div>

        </td>
        <td width=200>

        </td>
    </tr>


    <tr>
        <td height="200">
            玩家A
            <div id="show_a_uid"></div>
            <br />
            <div id="show_a_name"></div><br />
            <div id="show_a_hp"></div><br />
            <div id="show_a_dp"></div><br />
            <div id="show_a_direction"></div>

        </td>
        <td>
            <div id="show_fight"></div>
        </td>
        <td>
            玩家B
            <div id="show_b_uid"></div>
            <br />
            <div id="show_b_name"></div><br />
            <div id="show_b_hp"></div><br />
            <div id="show_b_dp"></div><br />
            <div id="show_b_direction"></div>
        </td>
    </tr>



    <tr>
        <td>

        </td>
        <td>
            <input type ="hidden" id="send_a" value="up" />
            <input type="submit" onclick="send_a();" value="上">
            <input type ="hidden" id="send_b" value="down" />
            <input type="submit" onclick="send_b();" value="下">
        </td>
        <td>

        </td>
    </tr>

</table>


<br />
<br />
-------------------------------
<div id="a"></div>
<br />
<br />

<br />
-------------------------------
<div id="b"></div>
</body>

</html>
